import{r as e,o as t,c as a,w as o,K as n,a as s,d as i,u as c,b as l,e as r,p as u,f as d,g as p,h as m,i as I,j as A,t as g,k as f,l as y,m as _,S as h,P as T,n as j,F as v,q as M,v as S,s as b,x as E,y as k,z as P,L as C,A as w,B as L,C as O,D as x,E as N,G as U,H as D,I as R,J as B,M as Q,N as V,O as $}from"./vendor.f24ab909.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const F={};F.render=function(i,c){const l=e("router-view");return t(),a(l,null,{default:o((({Component:e})=>[(t(),a(n,null,[(t(),a(s(e)))],1024))])),_:1})};const G={},X=function(e,t){return t&&0!==t.length?Promise.all(t.map((e=>{if((e=`/${e}`)in G)return;G[e]=!0;const t=e.endsWith(".css"),a=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${a}`))return;const o=document.createElement("link");return o.rel=t?"stylesheet":"modulepreload",t||(o.as="script",o.crossOrigin=""),o.href=e,document.head.appendChild(o),t?new Promise(((e,t)=>{o.addEventListener("load",e),o.addEventListener("error",t)})):void 0}))).then((()=>e())):e()};var q=i({name:"NavUser",emits:["goPage"],setup(e,t){const a=c(),o=l(),n=r((()=>a.state.user.userInfo));return{userInfo:n,goLogin:()=>{t.emit("goPage",`/login?redirect=${encodeURIComponent(o.path)}`)},goUser:()=>{t.emit("goPage",`/user/${n.value.loginname}`)}}}});u("data-v-cb756a7e");const z={class:"user-info"},H={class:"user-avatar"},K=["textContent"],W=A("img",{class:"icon-next",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAUCAMAAACOLiwjAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAArlBMVEUAAADIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMgAAADBIIPLAAAAOHRSTlMAF8A3wfE9KeX1QyTh9kof3flQG9j6WNP8XhTN/WYQyP5tDcJ2d8ZuE2fRXxrX+9tRIuD3KETyOKki2gwAAAABYktHRACIBR1IAAAACXBIWXMAAAsSAAALEgHS3X78AAAAf0lEQVQY003PWxeBQBQF4EZSiBQShaHItXLf//+X6WFm1zztb62zzpltiI5p8HVh9QjbQX9ADV2MxpQ3gR9Q0xnmISUWiJbUKkaypjZbyB21T4GsjYMeO0LmKp9iyLNefUF0Vfl2R6GPeiX8SuXHEy/90Xdd4dOU+zblRPpj/gNGXQvAFtkHDAAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNS0xMC0xNlQxNToyNDoyOCswODowMOV5G8UAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTUtMTAtMTZUMTU6MjQ6MjgrMDg6MDCUJKN5AAAAAElFTkSuQmCC",alt:""},null,-1);d(),q.render=function(e,a,o,n,s,i){const c=p("lazy");return t(),m("div",z,[e.userInfo.loginname?(t(),m("div",{key:1,class:"d-flex align-items-center",onClick:a[1]||(a[1]=(...t)=>e.goUser&&e.goUser(...t))},[I(A("img",H,null,512),[[c,e.userInfo.avatar_url]]),A("span",{class:"flex-1 text-ellipsis username",textContent:g(e.userInfo.loginname)},null,8,K),W])):(t(),m("div",{key:0,class:"btn-login",onClick:a[0]||(a[0]=(...t)=>e.goLogin&&e.goLogin(...t))}," 登录 "))])},q.__scopeId="data-v-cb756a7e";const Y="SET_TOPIC_DETAIL",J="SET_USER_INFO";var Z=i({name:"NavMenu",components:{NavUser:q},props:{show:{type:Boolean}},setup(e,t){const a=c(),o=f();return{goPage:e=>{t.emit("update:show",!1),o.push(e)},logout:()=>{t.emit("update:show",!1),window.sessionStorage.removeItem("user"),a.dispatch("user/SET_USER_INFO",{}),o.replace("/list")},token:r((()=>a.state.user.userInfo.token))}}});u("data-v-128b181a");const ee={class:"nav-menu"},te={class:"nav-menu-list"};d(),Z.render=function(a,o,n,s,i,c){const l=e("nav-user");return t(),m("section",ee,[y(l,{onGoPage:a.goPage},null,8,["onGoPage"]),A("section",te,[A("a",{class:"icon-quanbu iconfont nav-menu-item",onClick:o[0]||(o[0]=e=>a.goPage("/list?tab=all"))},"全部"),A("a",{class:"icon-hao iconfont nav-menu-item",onClick:o[1]||(o[1]=e=>a.goPage("/list?tab=good"))},"精华"),A("a",{class:"icon-fenxiang iconfont nav-menu-item",onClick:o[2]||(o[2]=e=>a.goPage("/list?tab=share"))},"分享"),A("a",{class:"icon-wenda iconfont nav-menu-item",onClick:o[3]||(o[3]=e=>a.goPage("/list?tab=ask"))},"问答"),A("a",{class:"icon-zhaopin iconfont nav-menu-item",onClick:o[4]||(o[4]=e=>a.goPage("/list?tab=job"))},"招聘"),A("a",{class:"icon-tianjia iconfont nav-menu-item",onClick:o[5]||(o[5]=e=>a.goPage("/list?tab=dev"))},"测试"),A("a",{class:"icon-xiaoxi iconfont nav-menu-item line",onClick:o[6]||(o[6]=e=>a.goPage("/message"))},"消息"),A("a",{class:"icon-about iconfont nav-menu-item",onClick:o[7]||(o[7]=e=>a.goPage("/about"))},"关于"),a.token?(t(),m("a",{key:0,class:"icon-shezhi iconfont nav-menu-item line",onClick:o[8]||(o[8]=(...e)=>a.logout&&a.logout(...e))},"退出")):_("",!0)])])},Z.__scopeId="data-v-128b181a";var ae=i({name:"NavHeader",components:{[h.name]:h,[T.name]:T,NavMenu:Z},props:{title:{type:String,default:""},showMenu:{type:Boolean,default:!0},topicId:{type:String,default:""},showAdd:{type:Boolean,default:!0}},setup(){const e=j(!1);return{show:e,showMenu:()=>{e.value=!0}}}});u("data-v-ef107258");const oe={class:"d-flex align-items-center justify-content-between navbar"},ne={key:1,class:"navbar-blank"},se=["textContent"],ie=A("i",{class:"iconfont navbar-icon-add"},"",-1);function ce(e,t){return t?b(e).fromNow().replace(" ",""):b(new Date(e)).format("YYYY-MM-DD HH:mm")}d(),ae.render=function(a,n,s,i,c,l){const r=e("router-link"),u=e("van-sticky"),d=e("nav-menu"),p=e("van-popup");return t(),m(v,null,[y(u,null,{default:o((()=>[A("header",oe,[a.showMenu?(t(),m("div",{key:0,class:"navbar-icon-menu",onClick:n[0]||(n[0]=(...e)=>a.showMenu&&a.showMenu(...e))})):(t(),m("div",ne)),A("div",{class:"flex-1 navbar-title",textContent:g(a.title)},null,8,se),M(a.$slots,"collect",{},void 0,!0),I(y(r,{to:`/add/${a.topicId}`},{default:o((()=>[ie])),_:1},8,["to"]),[[S,a.showAdd]])])])),_:3}),y(p,{show:a.show,"onUpdate:show":n[2]||(n[2]=e=>a.show=e),position:"left",teleport:"body"},{default:o((()=>[y(d,{show:a.show,"onUpdate:show":n[1]||(n[1]=e=>a.show=e)},null,8,["show"])])),_:1},8,["show"])],64)},ae.__scopeId="data-v-ef107258",b.extend(E),b.locale("zh-cn");const le=(e,t,a,o)=>{let n="",s="";if(a)n="置顶",s="top";else if(t)n="精华",s="good";else switch(e){case"share":n="分享",s="share";break;case"ask":n="问答",s="ask";break;case"job":n="招聘",s="job";break;case"dev":n="测试",s="test";break;default:n="暂无",s="default"}return o?s:n},re=(e=0)=>{document.body.scrollTop=e,document.documentElement.scrollTop=e};var ue=i({name:"TopicItem",props:{topic:{type:Object,default:{},required:!0}},methods:{getTabInfo:(e,t,a,o)=>le(e,t,a,o),getLastTimeStr:(e,t)=>ce(e,t)}});u("data-v-12d96483");const de={class:"topic van-hairline--bottom"},pe=["title"],me={class:"d-flex align-items-center content"},Ie={class:"avatar",alt:"用户头像"},Ae={class:"flex-1"},ge={class:"info"},fe={class:"name"},ye={key:0,class:"status"},_e={class:"info"};d(),ue.render=function(e,a,o,n,s,i){const c=p("lazy");return t(),m("div",de,[A("h3",{class:k(["text-ellipsis",e.getTabInfo(e.topic.tab,e.topic.good,e.topic.top,!0)]),title:e.getTabInfo(e.topic.tab,e.topic.good,e.topic.top,!1)},g(e.topic.title),11,pe),A("div",me,[I(A("img",Ie,null,512),[[c,e.topic.author.avatar_url]]),A("div",Ae,[A("p",ge,[A("span",fe,g(e.topic.author.loginname),1),e.topic.reply_count>0?(t(),m("span",ye,[A("b",null,g(e.topic.reply_count),1),P(" / "+g(e.topic.visit_count),1)])):_("",!0)]),A("p",_e,[A("time",null,g(e.getLastTimeStr(e.topic.create_at,!0)),1),A("time",null,g(e.getLastTimeStr(e.topic.last_reply_at,!0)),1)])])])])},ue.__scopeId="data-v-12d96483";var he=i({name:"TopicList",components:{[C.name]:C,[w.name]:w,TopicItem:ue},setup(){const e=c(),t=f(),a=l(),o=r((()=>e.state.topics.list)),n=r((()=>e.state.topics.finished)),s=r((()=>e.state.topics.tab)),i=j(!1),u=j(!0);L((()=>a.query),(async t=>{(null==t?void 0:t.tab)&&t.tab!==s.value&&(u.value=!0,e.commit("topics/SET_TOPICS_TAB",t.tab),await e.dispatch("topics/SET_TOPICS_INIT"),u.value=!1)})),O((async()=>{0===o.value.length&&(e.commit("topics/SET_TOPICS_TAB",a.query.tab||"all"),await e.dispatch("topics/SET_TOPICS_INIT")),u.value=!1}));return{skeletonLoading:u,topics:o,finished:n,loading:i,onLoad:async()=>{n.value||(await e.dispatch("topics/SET_TOPICS_LIST"),i.value=!1)},goDetail:a=>{t.push(`/topic/${a.id}`),e.dispatch("topic/SET_TOPIC_DETAIL",{id:a.id,token:e.state.user.userInfo.token})}}}});he.render=function(n,s,i,c,l,r){const u=e("topic-item"),d=e("van-list"),p=e("van-skeleton");return t(),a(p,{title:"",avatar:"",row:10,loading:n.skeletonLoading,class:"skeleton-top"},{default:o((()=>[y(d,{loading:n.loading,"onUpdate:loading":s[0]||(s[0]=e=>n.loading=e),finished:n.finished,"finished-text":"没有更多了",onLoad:n.onLoad},{default:o((()=>[(t(!0),m(v,null,x(n.topics,(e=>(t(),a(u,{key:e.id,topic:e,onClick:t=>n.goDetail(e)},null,8,["topic","onClick"])))),128))])),_:1},8,["loading","finished","onLoad"])])),_:1},8,["loading"])};const Te={all:"全部",good:"精华",share:"分享",ask:"问答",job:"招聘",dev:"测试"};var je=i({name:"ListPage",components:{NavHeader:ae,TopicList:he,BackTop:N((()=>X((()=>import("./back-top.a8d40987.js")),["assets/back-top.a8d40987.js","assets/back-top.9a2f43be.css","assets/vendor.f24ab909.js"])))},setup(){const e=c();return{title:r((()=>Te[e.state.topics.tab]))}}});je.render=function(a,o,n,s,i,c){const l=e("nav-header"),r=e("topic-list"),u=e("back-top");return t(),m(v,null,[y(l,{title:a.title},null,8,["title"]),y(r),y(u)],64)};const ve=[{path:"/",redirect:"/list"},{path:"/list",name:"List",component:je},{path:"/login",name:"Login",component:()=>X((()=>import("./index.b4f30562.js")),["assets/index.b4f30562.js","assets/index.7717a700.css","assets/user.76ae5e62.js","assets/vendor.f24ab909.js"])},{path:"/topic/:id",name:"Topic",component:()=>X((()=>import("./index.fe9e46a5.js")),["assets/index.fe9e46a5.js","assets/index.044097bb.css","assets/vendor.f24ab909.js"])},{path:"/message",name:"Message",component:()=>X((()=>import("./index.29cbe506.js")),["assets/index.29cbe506.js","assets/index.8ac7829c.css","assets/vendor.f24ab909.js"]),meta:{requiresAuth:!0}},{path:"/user/:loginname",name:"User",component:()=>X((()=>import("./index.f653384d.js")),["assets/index.f653384d.js","assets/index.b2b012a4.css","assets/vendor.f24ab909.js","assets/user.76ae5e62.js"]),meta:{requiresAuth:!0}},{path:"/about",name:"About",component:()=>X((()=>import("./index.951b14a8.js")),["assets/index.951b14a8.js","assets/index.c0b6af20.css","assets/vendor.f24ab909.js"])},{path:"/add/:id?",name:"Add",component:()=>X((()=>import("./index.32a78dcd.js")),["assets/index.32a78dcd.js","assets/index.dd2e000b.css","assets/vendor.f24ab909.js"]),meta:{requiresAuth:!0}}],Me=U({history:D("/"),routes:ve});function Se(e,t,a=20,o=!0){return R.get(`/topics?page=${e}&tab=${t}&limit=${a}&mdrender=${o}`)}R.defaults.baseURL="https://cnodejs.org/api/v1",R.interceptors.request.use((e=>e)),R.interceptors.response.use((e=>{const t=e.data.data||e.data;return e.data.success?t:Promise.reject(t)}),(e=>Promise.reject(e)));function be(e,t=!0,a=""){let o=`/topic/${e}?mdrender=${t}`;return a&&(o+=`&accesstoken=${a}`),R.get(o)}function Ee(e){return R.post(`/topic/${e.topic_id}/replies`,e)}function ke(e,t){return R.post(`/reply/${t}/ups`,{accesstoken:e})}function Pe(e,t){return R.post("/topic_collect/collect",{accesstoken:e,topic_id:t})}function Ce(e,t){return R.post("/topic_collect/de_collect",{accesstoken:e,topic_id:t})}var we=B({modules:{topics:{namespaced:!0,state:{tab:"all",finished:!1,limit:20,page:1,list:[]},mutations:{SET_TOPICS_TAB(e,t){e.tab=t},SET_TOPICS_LIST(e,t){e.list=[...e.list,...t],e.page+=1,e.finished=!t},SET_TOPICS_INIT(e){e.page=1,e.finished=!1,e.list=[]}},actions:{async SET_TOPICS_LIST({commit:e,state:t}){if(!t.finished)try{e("SET_TOPICS_LIST",await Se(t.page,t.tab,t.limit))}catch(a){}},async SET_TOPICS_INIT({commit:e,state:t}){e("SET_TOPICS_INIT");try{e("SET_TOPICS_LIST",await Se(t.page,t.tab,t.limit))}catch(a){}}}},topic:{namespaced:!0,state:{topic:{}},mutations:{SET_TOPIC_DETAIL(e,t){e.topic=t}},actions:{async SET_TOPIC_DETAIL({commit:e},t){t.reload||e("SET_TOPIC_DETAIL",{});try{e("SET_TOPIC_DETAIL",await be(t.id,t.mdrender,t.token))}catch(a){}}}},user:{namespaced:!0,state:{userInfo:{}},mutations:{SET_USER_INFO(e,t){e.userInfo=t}},actions:{SET_USER_INFO({commit:e},t){e("SET_USER_INFO",t)}}}}});window.sessionStorage.user&&we.dispatch("user/SET_USER_INFO",JSON.parse(window.sessionStorage.user)),Me.beforeEach(((e,t,a)=>{e.matched.some((e=>e.meta.requiresAuth))?we.state.user.userInfo.userId?a():a({path:"/login",query:{redirect:e.fullPath}}):a()})),Q(F).use(Me).use(we).use(V,{preload:1.5,lazyComponent:!0}).use($).mount("#app");export{J as S,ae as _,ce as a,X as b,Ce as c,Pe as d,Y as e,be as f,le as g,re as h,Ee as i,ke as j};
