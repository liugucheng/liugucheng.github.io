import{g as t,a,_ as o,b as e,c as s,d as i,e as c}from"./index.9874402d.js";import{d as n,p as l,f as p,g as r,o as d,h as u,i as f,m,j as v,t as _,y as g,A as b,R as k,E as h,b as y,u as T,e as I,U as w,V as E,W as L,r as j,l as x,X as A,w as C,c as S,Y as P,F as R}from"./vendor.f24ab909.js";var H=n({name:"TopicInfo",props:{topic:{type:Object,default:{},required:!0}},methods:{getTabInfo:(a,o,e,s)=>t(a,o,e,s),getLastTimeStr:(t,o)=>a(t,o)}});l("data-v-828d9746");const O={class:"d-flex align-items-center topic-info"},V={key:0,class:"topic-info-avatar"},q={class:"flex-1"},z={key:0},D={class:"topic-info-wrap"},M=["textContent"],W={class:"topic-info-name"};p(),H.render=function(t,a,o,e,s,i){const c=r("lazy");return d(),u("section",O,[t.topic.author?f((d(),u("img",V,null,512)),[[c,t.topic.author.avatar_url]]):m("",!0),v("div",q,[t.topic.author?(d(),u("span",z,_(t.topic.author.loginname),1)):m("",!0),v("time",null," 发布于："+_(t.getLastTimeStr(t.topic.create_at,!0)),1)]),v("div",D,[v("span",{class:g(["topic-info-tag",t.getTabInfo(t.topic.tab,t.topic.good,t.topic.top,!0)]),textContent:_(t.getTabInfo(t.topic.tab,t.topic.good,t.topic.top,!1))},null,10,M),v("span",W,_(t.topic.visit_count)+"次浏览",1)])])},H.__scopeId="data-v-828d9746";var $=n({name:"TopicPage",components:{[b.name]:b,[k.name]:k,NavHeader:o,TopicInfo:H,TopicReply:h((()=>e((()=>import("./topic-reply.eeb517f7.js")),["assets/topic-reply.eeb517f7.js","assets/topic-reply.19c82fb6.css","assets/index.9874402d.js","assets/index.37376068.css","assets/vendor.f24ab909.js"]))),BackTop:h((()=>e((()=>import("./back-top.a8d40987.js")),["assets/back-top.a8d40987.js","assets/back-top.9a2f43be.css","assets/index.9874402d.js","assets/index.37376068.css","assets/vendor.f24ab909.js"])))},setup(){const t=y(),a=T(),o=I((()=>a.state.topic.topic)),e=I((()=>a.state.user.userInfo.token)),n=I((()=>a.state.topic.topic.author_id===a.state.user.userInfo.userId));w((async()=>{const e=t.params.id;o.value.id&&o.value.id===e||await a.dispatch(`topic/${c}`,{id:e}),E((()=>{const t=document.querySelectorAll(".markdown-body img"),a=[];t.forEach(((t,o)=>{let e=t.getAttribute("src");e.startsWith("http")||(e=`https:${e}`),a.push(e),t.addEventListener("click",(()=>{L({images:a,startPosition:o,closeable:!0,teleport:"body"})}))}))}))}));return{topic:o,token:e,toggleCollect:async a=>{const c=t.params.id;if(a){(await s(e.value,c)).success&&(o.value.is_collect=!1)}else{(await i(e.value,c)).success&&(o.value.is_collect=!0)}},isSelf:n}}});l("data-v-5b9a8ae4");const B={class:"topic-title"},F=["innerHTML"];p(),$.render=function(t,a,o,e,s,i){const c=j("van-icon"),n=j("nav-header"),l=j("topic-info"),p=j("van-skeleton"),r=j("topic-reply"),f=j("back-top");return d(),u(R,null,[x(n,{title:"主题","topic-id":t.isSelf?t.topic.id:""},A({_:2},[t.token?{name:"collect",fn:C((()=>[x(c,{name:"like",size:"20",color:t.topic.is_collect?"#80bd01":"#000000",onClick:a[0]||(a[0]=a=>t.toggleCollect(t.topic.is_collect))},null,8,["color"])]))}:void 0]),1032,["topic-id"]),v("h2",B,_(t.topic.title),1),x(p,{title:"",avatar:"",row:5,loading:!t.topic.id,class:"skeleton-top"},{default:C((()=>[x(l,{topic:t.topic},null,8,["topic"]),v("section",{class:"markdown-body topic-content van-hairline--bottom",innerHTML:t.topic.content},null,8,F)])),_:1},8,["loading"]),(d(),S(P,null,{default:C((()=>[x(r,{topic:t.topic},null,8,["topic"])])),fallback:C((()=>[x(p,{title:"",row:5,class:"skeleton-top"})])),_:1})),x(f)],64)},$.__scopeId="data-v-5b9a8ae4";export{$ as default};
