import{d as L,h as d,Y as h,r as s,o as A,f as R,w as o,b as a,l as v,a2 as x,E as w}from"./index.afbe2883.js";import{u as B,a as K,b as I}from"./role.6ff858a3.js";const $=L({__name:"add-or-update",emits:["refreshDataList"],setup(M,{expose:k,emit:b}){const r=d(!1),p=d([]),n=d(),m=d(),t=h({id:"",name:"",menuIdList:[],orgIdList:[],remark:""}),C=l=>{r.value=!0,t.id="",m.value&&m.value.resetFields(),n.value&&n.value.setCheckedKeys([]),l&&E(l),g()},g=()=>B().then(l=>{p.value=l.data}),E=l=>{K(l).then(e=>{Object.assign(t,e.data),t.menuIdList.forEach(i=>n.value.setChecked(i,!0))})},F=d({name:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),c=()=>{m.value.validate(l=>{if(!l)return!1;t.menuIdList=[...n.value.getHalfCheckedKeys(),...n.value.getCheckedKeys()],I(t).then(()=>{w.success({message:"\u64CD\u4F5C\u6210\u529F",duration:500,onClose:()=>{r.value=!1,b("refreshDataList")}})})})};return k({init:C}),(l,e)=>{const i=s("el-input"),f=s("el-form-item"),V=s("el-tree"),y=s("el-form"),_=s("el-button"),D=s("el-dialog");return A(),R(D,{modelValue:r.value,"onUpdate:modelValue":e[5]||(e[5]=u=>r.value=u),title:t.id?"\u4FEE\u6539":"\u65B0\u589E","close-on-click-modal":!1,draggable:""},{footer:o(()=>[a(_,{onClick:e[3]||(e[3]=u=>r.value=!1)},{default:o(()=>[v("\u53D6\u6D88")]),_:1}),a(_,{type:"primary",onClick:e[4]||(e[4]=u=>c())},{default:o(()=>[v("\u786E\u5B9A")]),_:1})]),default:o(()=>[a(y,{ref_key:"dataFormRef",ref:m,model:t,rules:F.value,"label-width":"120px",onKeyup:e[2]||(e[2]=x(u=>c(),["enter"]))},{default:o(()=>[a(f,{prop:"name",label:"\u540D\u79F0"},{default:o(()=>[a(i,{modelValue:t.name,"onUpdate:modelValue":e[0]||(e[0]=u=>t.name=u),placeholder:"\u540D\u79F0"},null,8,["modelValue"])]),_:1}),a(f,{prop:"remark",label:"\u5907\u6CE8"},{default:o(()=>[a(i,{modelValue:t.remark,"onUpdate:modelValue":e[1]||(e[1]=u=>t.remark=u),placeholder:"\u5907\u6CE8"},null,8,["modelValue"])]),_:1}),a(f,{label:"\u83DC\u5355\u6743\u9650"},{default:o(()=>[a(V,{ref_key:"menuListTree",ref:n,data:p.value,props:{label:"name",children:"children"},"node-key":"id",accordion:"","show-checkbox":""},null,8,["data"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}});export{$ as _};
